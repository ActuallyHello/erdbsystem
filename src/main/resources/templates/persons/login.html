<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title th:text="${title}"></title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@1.0.2/css/bulma.min.css">
</head>
</head>
<body>

<nav th:insert="~{navbar :: navbar}"></nav>

<div class="columns ml-6 mr-6 mt-2">
    <div class="column">

        <div class="box">
            <div class="container">
                <div class="columns">
                    <div class="column is-4 is-offset-4">
                        <h1 class="title has-text-centered">Авторизация</h1>

                        <form action="/login" method="POST" id="login-form">
                            <div class="field">
                                <label>Логин</label>
                                <div class="control">
                                    <input type="text" class="input" id="login" name="login" required>
                                </div>
                            </div>

                            <div class="field">
                                <label>Пароль</label>
                                <div class="control">
                                    <input type="password" id="password" class="input" name="password" required>
                                </div>
                            </div>

                            <div class="field">
                                <div class="control has-text-centered">
                                    <button type="submit" class="button is-success">Войти</button>
                                </div>
                            </div>

                            <div class="field mt-2">
                                <div class="control has-text-centered">
                                    <a href="/registration" class="button is-info">Зарегистрироваться</a>
                                </div>
                            </div>

                            <div th:if="${error != null}" id="response-message" class="notification is-danger">
                                <span th:text="${error}"></span>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>


<script>

<!--    const form = document.getElementById('login-form');-->

<!--    form.onsubmit = async function(event) {-->
<!--        event.preventDefault(); // Предотвращаем перезагрузку страницы-->

<!--        const responseMessage = document.getElementById('response-message');-->

<!--        const login = document.getElementById('login').value;-->
<!--        const password = document.getElementById('password').value;-->

<!--        try {-->
<!--            const userFormData = new FormData();-->
<!--            userFormData.append("login", login);-->
<!--            userFormData.append("password", password);-->

<!--            const userResponse = await fetch(`http://localhost:8080/logins`, {-->
<!--                method: 'POST',-->
<!--                body: userFormData-->
<!--            });-->
<!--            if (userResponse.ok) {-->
<!--                const userResult = await userResponse.json();-->
<!--                window.location.href = "http://localhost:8080/"-->
<!--            } else {-->
<!--                console.log(userResponse);-->
<!--                responseMessage.classList.remove('is-hidden', 'is-success')-->
<!--                responseMessage.classList.add('is-danger');-->
<!--                responseMessage.textContent = 'Неверные данные пользователя!'-->
<!--            }-->
<!--        } catch (error) {-->
<!--            console.log(error);-->
<!--            responseMessage.classList.remove('is-hidden', 'is-success')-->
<!--            responseMessage.classList.add('is-danger');-->
<!--            responseMessage.textContent = 'Произошла ошибка при отправке запроса.'-->
<!--        }-->
<!--    };-->
</script>

</body>
</html>